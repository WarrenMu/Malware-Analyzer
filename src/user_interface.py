import os
import sys
from .malware_behavior_analyzer import analyzer

sys.path.insert(0, os.path.abspath(os.path.dirname(__file__)))

from file_parser import extract_imports
from malware_analysis import identify_malware_behavior

def main():
    """Main function to provide a user interface for the tool."""
    file_path = input('Enter the path to the executable file: ')
    imports = extract_imports(file_path)
    behavior = identify_malware_behavior(imports)
    if behavior:
        print(f'Potential malware behavior identified: {behavior}')
    else:
        print('No potential malware behavior identified.')
        
if __name__ == '__main__':
    main()
# import malware_behavior_analyzer

# def main():
#     print("Welcome to Malware Behavior Analyzer")
#     filepath = input("Enter the path to the malware file: ")
#     report = malware_behavior_analyzer.analyze(filepath)
#     print(report)

# if __name__ == '__main__':
#     main()
